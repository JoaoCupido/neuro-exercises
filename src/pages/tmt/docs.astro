---
import Layout from '../../layouts/Layout.astro';
import ParameterDoc from '../../components/ParameterDoc.astro';
import BackgroundDocs from '../../components/BackgroundDocs.astro';
import GridDocs from '../../components/GridDocs.astro';
---

<Layout title="TMT API Documentation - Neuro Exercises">
    <main class="min-h-screen bg-background">
        <!-- Header -->
        <header class="bg-gradient-to-r from-primary/10 to-secondary/10 border-b border-border py-12 px-4 sm:px-6 lg:px-8">
            <div class="mx-auto max-w-4xl">
                <div class="flex items-center gap-3 mb-2">
                    <div class="w-3 h-3 rounded-full bg-primary"></div>
                    <span class="text-sm font-medium text-primary">API Documentation</span>
                </div>
                <h1 class="text-4xl font-bold text-foreground mb-3">Trail Making Test Configuration</h1>
                <p class="text-muted-foreground text-lg max-w-2xl">
                    Learn how to customize the Trail Making Test experience using URL parameters for research, clinical, or educational purposes.
                </p>

                <!-- Quick Navigation -->
                <div class="flex flex-wrap gap-2 mt-6">
                    <a href="#basic-parameters" class="text-sm bg-background hover:bg-secondary border border-border px-3 py-1.5 rounded-full transition-colors">
                        Basic Parameters
                    </a>
                    <a href="#appearance" class="text-sm bg-background hover:bg-secondary border border-border px-3 py-1.5 rounded-full transition-colors">
                        Appearance
                    </a>
                    <a href="#behavior" class="text-sm bg-background hover:bg-secondary border border-border px-3 py-1.5 rounded-full transition-colors">
                        Behavior
                    </a>
                    <a href="#results" class="text-sm bg-background hover:bg-secondary border border-border px-3 py-1.5 rounded-full transition-colors">
                        Results
                    </a>
                    <a href="#advanced" class="text-sm bg-background hover:bg-secondary border border-border px-3 py-1.5 rounded-full transition-colors">
                        Advanced
                    </a>
                </div>
            </div>
        </header>

        <div class="py-12 px-4 sm:px-6 lg:px-8">
            <div class="mx-auto max-w-4xl">
                <!-- Introduction -->
                <div class="prose prose-lg max-w-none mb-12">
                    <p class="text-muted-foreground">
                        The Trail Making Test (TMT) API allows you to customize the test experience through URL parameters.
                        These parameters control everything from test length and appearance to behavior and result display.
                    </p>
                </div>

                <div class="space-y-10">
                    <!-- Basic Parameters Section -->
                    <section id="basic-parameters">
                        <div class="flex items-center gap-3 mb-6">
                            <div class="w-2 h-8 bg-primary rounded-full"></div>
                            <h2 class="text-2xl font-bold text-foreground">Basic Parameters</h2>
                        </div>
                        <p class="text-muted-foreground mb-6">Core parameters that define the test structure and content.</p>

                        <div class="space-y-6">
                            <ParameterDoc
                                    name="trailLength"
                                    description="Sets the total number of items in the trail. For numbers-letters mode, this should be an even number."
                                    type="Number"
                                    defaultValue="10"
                                    examples={["/?trailLength=8", "/?trailLength=16"]}
                                    codeExample="?trailLength=12"
                            />

                            <ParameterDoc
                                    name="symbolType"
                                    description="Defines the type and sequence of symbols. Options: numbers, letters, numbers-letters, letters-numbers."
                                    type="String"
                                    defaultValue="numbers"
                                    examples={["/?symbolType=letters", "/?symbolType=numbers-letters"]}
                                    codeExample="?symbolType=letters-numbers"
                            />

                            <ParameterDoc
                                    name="reverseOrder"
                                    description="When set to true, reverses the order of the symbols."
                                    type="Boolean"
                                    defaultValue="false"
                                    examples={["/?reverseOrder=true", "/?symbolType=numbers&reverseOrder=true"]}
                                    codeExample="?reverseOrder=true"
                            />
                        </div>
                    </section>

                    <!-- Appearance Section -->
                    <section id="appearance">
                        <div class="flex items-center gap-3 mb-6">
                            <div class="w-2 h-8 bg-primary rounded-full"></div>
                            <h2 class="text-2xl font-bold text-foreground">Appearance</h2>
                        </div>
                        <p class="text-muted-foreground mb-6">Parameters that control the visual presentation of the test.</p>

                        <div class="space-y-6">
                            <ParameterDoc
                                    name="numberRadius"
                                    description="Controls the size of the clickable circles in pixels."
                                    type="Number"
                                    defaultValue="30"
                                    examples={["/?numberRadius=25", "/?numberRadius=40"]}
                                    codeExample="?numberRadius=35"
                            />

                            <ParameterDoc
                                    name="textSize"
                                    description="Controls the size of the text inside circles in pixels."
                                    type="Number"
                                    defaultValue="18"
                                    examples={["/?textSize=16", "/?textSize=24"]}
                                    codeExample="?textSize=20"
                            />

                            <ParameterDoc
                                    name="showTimer"
                                    description="Shows or hides the timer display during the test."
                                    type="Boolean"
                                    defaultValue="true"
                                    examples={["/?showTimer=false"]}
                                    codeExample="?showTimer=false"
                            />

                            <ParameterDoc
                                    name="linesUnderDots"
                                    description="Controls whether connection lines appear under (true) or over (false) the dots."
                                    type="Boolean"
                                    defaultValue="true"
                                    examples={["/?linesUnderDots=false"]}
                                    codeExample="?linesUnderDots=false"
                            />

                            <!-- Reusable Background Documentation -->
                            <BackgroundDocs />

                            <!-- Reusable Grid Documentation -->
                            <GridDocs />
                        </div>
                    </section>

                    <!-- Behavior Section -->
                    <section id="behavior">
                        <div class="flex items-center gap-3 mb-6">
                            <div class="w-2 h-8 bg-primary rounded-full"></div>
                            <h2 class="text-2xl font-bold text-foreground">Behavior</h2>
                        </div>
                        <p class="text-muted-foreground mb-6">Parameters that control how the test responds to user interactions.</p>

                        <div class="space-y-6">
                            <ParameterDoc
                                    name="allowWrongSelections"
                                    description="When true, wrong selections are recorded and visualized but the test continues. When false, wrong selections are counted as errors but not selected."
                                    type="Boolean"
                                    defaultValue="false"
                                    examples={["/?allowWrongSelections=true"]}
                                    codeExample="?allowWrongSelections=true"
                            />

                            <ParameterDoc
                                    name="showWrongSelections"
                                    description="When true, wrong selections are visually shown as red in canvas. When false, wrong selections are visually shown as correct (still counts wrong in results data) in canvas."
                                    type="Boolean"
                                    defaultValue="true"
                                    examples={["/?showWrongSelections=true"]}
                                    codeExample="?showWrongSelections=true"
                            />
                        </div>
                    </section>

                    <!-- Results Section -->
                    <section id="results">
                        <div class="flex items-center gap-3 mb-6">
                            <div class="w-2 h-8 bg-primary rounded-full"></div>
                            <h2 class="text-2xl font-bold text-foreground">Results Display</h2>
                        </div>
                        <p class="text-muted-foreground mb-6">Parameters that control what information is shown after test completion.</p>

                        <div class="space-y-6">
                            <ParameterDoc
                                    name="hidePopupButtons"
                                    description="Hides the restart and menu buttons in the results popup."
                                    type="Boolean"
                                    defaultValue="false"
                                    examples={["/?hidePopupButtons=true"]}
                                    codeExample="?hidePopupButtons=true"
                            />

                            <ParameterDoc
                                    name="hidePopupResults"
                                    description="Hides the time and errors display in the results popup."
                                    type="Boolean"
                                    defaultValue="false"
                                    examples={["/?hidePopupResults=true"]}
                                    codeExample="?hidePopupResults=true"
                            />

                            <ParameterDoc
                                    name="hidePopupAll"
                                    description="When set to true, completely hides the results popup after test completion."
                                    type="Boolean"
                                    defaultValue="false"
                                    examples={["/?hidePopupAll=true"]}
                                    codeExample="?hidePopupAll=true"
                            />
                        </div>
                    </section>

                    <!-- Advanced Section -->
                    <section id="advanced">
                        <div class="flex items-center gap-3 mb-6">
                            <div class="w-2 h-8 bg-primary rounded-full"></div>
                            <h2 class="text-2xl font-bold text-foreground">Advanced Configuration</h2>
                        </div>
                        <p class="text-muted-foreground mb-6">Advanced parameters for custom positioning and complex configurations.</p>

                        <div class="space-y-6">
                            <ParameterDoc
                                    name="customPositions"
                                    description="Sets custom positions for dots as percentage coordinates (0-100). Uses URL-encoded JSON array of {x, y} objects."
                                    type="URL-encoded JSON"
                                    defaultValue="None"
                                    examples={[]}
                                    codeExample="?customPositions=%5B%7B%22x%22%3A10%2C%22y%22%3A20%7D%2C%7B%22x%22%3A30%2C%22y%22%3A40%7D%5D"
                            />

                            <!-- Custom Positions Format -->
                            <div class="bg-card border border-border rounded-lg p-6">
                                <h3 class="text-xl font-bold text-foreground mb-3">Custom Positions Format</h3>
                                <p class="text-muted-foreground mb-4">
                                    Custom positions use percentage-based coordinates (0.00-100.00) to ensure consistent placement across different screen sizes.
                                    Decimal values are supported for precise positioning.
                                </p>

                                <div class="bg-secondary rounded-lg p-4 mb-4 relative group">
                                    <button class="absolute top-3 right-3 opacity-0 group-hover:opacity-100 transition-opacity bg-background/80 p-1.5 rounded text-xs"
                                            onclick="navigator.clipboard.writeText(document.getElementById('positions-json').textContent)">
                                        Copy JSON
                                    </button>
                                    <pre class="text-sm text-foreground font-mono overflow-x-auto" id="positions-json"><code>{
                                        "[\n" +
                                        "  {\"x\": 10.2, \"y\": 20.5},  // 10.2% from left, 20.5% from top\n" +
                                        "  {\"x\": 30, \"y\": 40},  // 30% from left, 40% from top\n" +
                                        "  {\"x\": 50, \"y\": 60},  // 50% from left, 60% from top\n" +
                                        "  {\"x\": 70, \"y\": 30},  // 70% from left, 30% from top\n" +
                                        "  {\"x\": 90, \"y\": 80}   // 90% from left, 80% from top\n" +
                                        "]"
                                    }</code></pre>
                                </div>

                                <p class="text-muted-foreground">
                                    The number of positions should match the trail length. If fewer positions are provided,
                                    the remaining dots will be placed randomly. Decimal values up to 2 decimal places are recommended.
                                </p>
                            </div>
                        </div>
                    </section>

                    <!-- Complete Example -->
                    <section>
                        <div class="bg-primary/10 border border-primary rounded-lg p-6">
                            <h2 class="text-2xl font-bold text-foreground mb-3">Complete Example</h2>
                            <p class="text-muted-foreground mb-4">A full TMT configuration example with custom positions:</p>
                            <div class="bg-secondary rounded-lg p-4 overflow-x-auto relative group">
                                <button class="absolute top-3 right-3 opacity-0 group-hover:opacity-100 transition-opacity bg-background/80 p-1.5 rounded text-xs"
                                        onclick="navigator.clipboard.writeText(document.getElementById('complete-example').textContent)">
                                    Copy URL
                                </button>
                                <code class="text-sm text-foreground font-mono whitespace-nowrap" id="complete-example">
                                    /tmt?trailLength=5&numberRadius=35&symbolType=numbers&reverseOrder=false&showTimer=true&customPositions=%5B%7B%22x%22%3A10%2C%22y%22%3A20%7D%2C%7B%22x%22%3A30%2C%22y%22%3A40%7D%2C%7B%22x%22%3A50%2C%22y%22%3A60%7D%2C%7B%22x%22%3A70%2C%22y%22%3A30%7D%2C%7B%22x%22%3A90%2C%22y%22%3A80%7D%5D
                                </code>
                            </div>
                        </div>
                    </section>
                </div>
            </div>
        </div>
    </main>

    <script>
        // Smooth scrolling for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });
    </script>
</Layout>