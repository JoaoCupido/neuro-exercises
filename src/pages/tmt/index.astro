---
import Layout from '../../layouts/Layout.astro';
---

<Layout title="Trail Making Test - Neuro Exercises" hideNavbar={true}>
    <main class="min-h-screen bg-background relative">
        <!-- Timer Display -->
        <div id="timer" class="z-50 fixed top-4 right-4 bg-card border border-border rounded-lg px-4 py-2 text-foreground font-medium shadow-lg w-36 text-center">
            0
        </div>

        <!-- Results Popup - Now outside the main container -->
        <div id="popup" class="fixed inset-0 flex items-center justify-center bg-black/70 z-50 hidden">
            <div class="bg-card border border-border rounded-lg p-8 max-w-md mx-4 text-center">
                <h3 class="text-2xl font-bold text-foreground mb-4">Test Completed!</h3>
                <div class="space-y-3 mb-6">
                    <p id="popupTimer" class="text-foreground">Time: 0 seconds</p>
                    <p id="popupErrors" class="text-foreground">Errors: 0</p>
                </div>
                <div class="flex flex-col sm:flex-row gap-3" id="buttonContainer">
                    <button id="restartButton" class="bg-primary text-primary-foreground px-6 py-3 rounded-lg font-medium hover:bg-primary/90 transition-colors">
                        Restart Test
                    </button>
                    <a
                            href={`./`}
                            class="bg-secondary text-secondary-foreground px-6 py-3 rounded-lg font-medium hover:bg-accent transition-colors text-center"
                    >
                        Back to Menu
                    </a>
                </div>
            </div>
        </div>

        <!-- Canvas Container Only -->
        <div class="absolute inset-0">
            <canvas id="bgColorCanvas" class="absolute inset-0"></canvas>
            <canvas id="bgImageCanvas" class="absolute inset-0"></canvas>
            <canvas id="gridCanvas" class="absolute inset-0 pointer-events-none"></canvas>
            <canvas id="trailCanvas" class="absolute inset-0"></canvas>
        </div>
    </main>

    <script type="module" is:inline src={`${process.env.GITHUB_PAGES ? import.meta.env.BASE_URL : ""}/scripts/TMTCanvasManager.js`}></script>
</Layout>